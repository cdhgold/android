 <uses-permission android:name="android.permission.INTERNET" />
    <uses-permission android:name="android.permission.READ_EXTERNAL_STORAGE" />
    <uses-permission android:name="android.permission.WRITE_EXTERNAL_STORAGE" />

    <application
        android:requestLegacyExternalStorage="true"
        android:usesCleartextTraffic="true"
        
public class MainActivity extends AppCompatActivity {
    private ImageView carImg01;
    @Override
    protected void onCreate(Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.activity_main);
        carImg01 = (ImageView)findViewById(R.id.carImg01);
        Bitmap bitmap = ((BitmapDrawable)carImg01.getDrawable()).getBitmap();

        try {
            File filePath = new File(Environment.getRootDirectory()+"/car/"   );
            if(!filePath.exists()){
                filePath.mkdirs();
            }
            //file.createNewFile();
            File file  = new File(getApplicationContext().getFilesDir()+"/carImg01.jpg"   );

            OutputStream out = new FileOutputStream(file);
            bitmap.compress(Bitmap.CompressFormat.JPEG, 100, out);
            Send send  = new Send(file);
            send.start( );

            out.close();
        } catch (Exception e) {

            e.printStackTrace();

        } finally {

            try {

            } catch ( Exception e) {
                e.printStackTrace();
            }
        }


    }


    class Send  extends Thread{
        public File file;
        public Send(File f){
            this.file = f;

        }
        @Override
        public void run() {
            // tag 인식속성
            // AndroidNetworking.forceCancel("tag"); // 취소시
            //
            Log.d("campCar",file.getName());
            Log.d("campCar", String.valueOf(file.length())  );

            String uploadUrl = "http://konginfo.co.kr/car/carIns/saveApp";
           /*
            AndroidNetworking.post(uploadUrl)
                    .addBodyParameter("carNm", "cdhgold1")
                    .addBodyParameter("carAmt", "1000")
                    .addBodyParameter("carTel", "010")
                    .addBodyParameter("carAddr", "aaa")
                    .addBodyParameter("carYear", "2020")
                    .addBodyParameter("carKm",	 "1000")
                    .addBodyParameter("carFuel", " ")
                    .addBodyParameter("carInfo", "test ")
                    //.addFileBody(file) // posting any type of file
                    .setTag("campCar")
                    .setPriority(Priority.MEDIUM)
                    .build()
                    .getAsJSONObject(new JSONObjectRequestListener() {
                        @Override
                        public void onResponse(JSONObject response) {
                            System.out.println("car=>"+response);
                        }
                        @Override
                        public void onError(ANError error) {
                            // handle error
                            System.out.println("car error=>"+error);
                        }
                    });
                    */

                AndroidNetworking.upload(uploadUrl)
                    .addMultipartFile("carImg01",file)
                    .addMultipartParameter("carNm","대현캠핑카")
                    .setTag("campCar")
                    .setPriority(Priority.HIGH)
                    .build()
                    .setUploadProgressListener(new UploadProgressListener() {
                        @Override
                        public void onProgress(long bytesUploaded, long totalBytes) {
                            // do anything with progress
                            Log.d("responce_app",String.valueOf(bytesUploaded));
                        }
                    })
                    .getAsJSONObject(new JSONObjectRequestListener() {
                        @Override
                        public void onResponse(JSONObject response) {
                            // do anything with response
                            Log.d("responce_app",String.valueOf(response));
                        }
                        @Override
                        public void onError(ANError error) {
                            // handle error
                            Log.d("responce_app err ",String.valueOf(error));
                            Log.d("responce_app err ","errorrrr");
                        }
                    });
        }// end run
